Page User_Settings
    Events
        Preinitialize Event
            // Display username
            if(User_Settings.userNum.val==0)
            {
                tUser.txt=" "+User_Settings.u0Name.txt
            }else if(User_Settings.userNum.val==1)
            {
                tUser.txt=" "+User_Settings.u1Name.txt
            }else if(User_Settings.userNum.val==2)
            {
                tUser.txt=" "+User_Settings.u2Name.txt
            }
            //
            // Load global variable values into local variables. Note: Since a component consists of many different properties (like font size, color, position, ...) its memory footprint is much larger and it should not be global.
            tU0Name.txt=u0Name.txt
            tU0Code.txt=u0Code.txt
            tU1Name.txt=u1Name.txt
            tU1Code.txt=u1Code.txt
            tU2Name.txt=u2Name.txt
            tU2Code.txt=u2Code.txt
            user0Ontime.val=u0Ontime.val
            user0BPS.val=u0BPS.val
            user0Duty.val=u0Duty.val
            user1Ontime.val=u1Ontime.val
            user1BPS.val=u1BPS.val
            user1Duty.val=u1Duty.val
            user2Ontime.val=u2Ontime.val
            user2BPS.val=u2BPS.val
            user2Duty.val=u2Duty.val
            //
            // Each user can only see the settings of himself and "lower" users. Only user 2 can edit them.
            if(User_Settings.userNum.val!=2)
            {
                vis tU2Name,0
                vis tU2Code,0
                vis user2Ontime,0
                vis user2BPS,0
                vis user2Duty,0
                vis tus2,0
                vis tHz2,0
                vis tPerc2,0
                if(User_Settings.userNum.val!=1)
                {
                    vis tU1Name,0
                    vis tU1Code,0
                    vis user1Ontime,0
                    vis user1BPS,0
                    vis user1Duty,0
                    vis tus1,0
                    vis tHz1,0
                    vis tPerc1,0
                    vis tSelToMod,0
                    vis b0,0
                    vis b1,0
                    vis b2,0
                    vis b3,0
                    vis b4,0
                    vis b5,0
                    vis b6,0
                    vis b7,0
                    vis b8,0
                    vis b9,0
                    vis bClear,0
                    vis bOK,0
                    if(User_Settings.userNum.val!=0)
                    {
                        vis tU0Name,0
                        vis tU0Code,0
                        vis user0Ontime,0
                        vis user0BPS,0
                        vis user0Duty,0
                        vis tus0,0
                        vis tHz0,0
                        vis tPerc0,0
                    }
                }
            }
            //
            // Idle field is just used for default text/background color and as target for the numpad if no component is selected. Ergo should be hidden,
            vis idle,0
            newValTargetId.val=idle.id
        
        Postinitialize Event
            // Draw table grid
            //
            // Right border of the table
            sys0=0
            if(User_Settings.userNum.val==0)
            {
                sys0=362
            }else if(User_Settings.userNum.val==1)
            {
                sys0=577
            }else if(User_Settings.userNum.val==2)
            {
                sys0=785
            }
            // Horizontal grid lines
            for(sys2=0;sys2<4;sys2++)
            {
                sys1=sys2*31
                sys1+=116
                line 15,sys1,sys0,sys1,tUserName.pco
            }
            //
            // Table height
            sys1+=31
            // Vertical grid lines
            for(sys2=148;sys2<sys0;sys2+=215)
            {
                line sys2,90,sys2,sys1,tUserName.pco
            }
        
        Touch Press Event
            
        Touch Release Event
            
        Page Exit Event
            // Store local component values in global variables. Note: Since a component consists of many different properties (like font size, color, position, ...) its memory footprint is much larger and it should not be global.
            u0Name.txt=tU0Name.txt
            u0Code.txt=tU0Code.txt
            u1Name.txt=tU1Name.txt
            u1Code.txt=tU1Code.txt
            u2Name.txt=tU2Name.txt
            u2Code.txt=tU2Code.txt
            u0Ontime.val=user0Ontime.val
            u0BPS.val=user0BPS.val
            u0Duty.val=user0Duty.val
            u1Ontime.val=user1Ontime.val
            u1BPS.val=user1BPS.val
            u1Duty.val=user1Duty.val
            u2Ontime.val=user2Ontime.val
            u2BPS.val=user2BPS.val
            u2Duty.val=user2Duty.val
        
    Components
        Text tTitle
            Properties
                Scope       : Local
                Initial Text: "User Settings"
                Max. length : 22
            
            Events
                Touch Press Event
                    
                Touch Release Event
                    
        Button bReturn
            Properties
                Scope      : Local
                Caption    : "Return"
                Max. length: 10
            
            Events
                Touch Press Event
                    // Store local component values in global variables. Note: Since a component consists of many different properties (like font size, color, position, ...) its memory footprint is much larger and it should not be global.
                    click bOK,0
                    u0Name.txt=tU0Name.txt
                    u0Code.txt=tU0Code.txt
                    u1Name.txt=tU1Name.txt
                    u1Code.txt=tU1Code.txt
                    u2Name.txt=tU2Name.txt
                    u2Code.txt=tU2Code.txt
                    u0Ontime.val=user0Ontime.val
                    u0BPS.val=user0BPS.val
                    u0Duty.val=user0Duty.val
                    u1Ontime.val=user1Ontime.val
                    u1BPS.val=user1BPS.val
                    u1Duty.val=user1Duty.val
                    u2Ontime.val=user2Ontime.val
                    u2BPS.val=user2BPS.val
                    u2Duty.val=user2Duty.val
                    //
                    // Serial Data format: 'u', Data Byte 1, 2, ...
                    // Byte 1:
                    //   Bit 6-7: User. Can be 0, 1 or 2.
                    //   Bit   5: Indicates content of the following bytes. 0 = Name, 1 = Password
                    //   Bit 0-4: Number of following bytes minus one. This means Name or password are at least 1 character and at most 32 characters.
                    // Byte 2-x: Characters of the username/password without null termination character.
                    //
                    // sys0 will contain byte 1.
                    // sys1 is used as temp variable
                    // Start with user 0, name, then his password, then user 1 name, etc.
                    strlen tU0Name.txt,sys0
                    sys0-=1
                    sys0=sys0&0x1f
                    prints "u",1
                    prints sys0,1
                    sys0+=1
                    prints tU0Name.txt,sys0
                    //
                    strlen tU0Code.txt,sys0
                    sys0-=1
                    sys0=sys0&0x1f
                    sys1=1<<5
                    sys0+=sys1
                    prints "u",1
                    prints sys0,1
                    sys0+=1
                    prints tU0Code.txt,sys0
                    //
                    strlen tU1Name.txt,sys0
                    sys0-=1
                    sys0=sys0&0x1f
                    sys1=1<<6
                    sys0+=sys1
                    prints "u",1
                    prints sys0,1
                    sys0+=1
                    prints tU1Name.txt,sys0
                    //
                    strlen tU1Code.txt,sys0
                    sys0-=1
                    sys0=sys0&0x1f
                    sys1=1<<6
                    sys0+=sys1
                    sys1=1<<5
                    sys0+=sys1
                    prints "u",1
                    prints sys0,1
                    sys0+=1
                    prints tU1Code.txt,sys0
                    //
                    strlen tU2Name.txt,sys0
                    sys0-=1
                    sys0=sys0&0x1f
                    sys1=2<<6
                    sys0+=sys1
                    prints "u",1
                    prints sys0,1
                    sys0+=1
                    prints tU2Name.txt,sys0
                    //
                    strlen tU2Code.txt,sys0
                    sys0-=1
                    sys0=sys0&0x1f
                    sys1=2<<6
                    sys0+=sys1
                    sys1=1<<5
                    sys0+=sys1
                    prints "u",1
                    prints sys0,1
                    sys0+=1
                    prints tU2Code.txt,sys0
                    // Serial Data format: 'd', Data Byte 1, 2, 3, 4, 5
                    // Data byte 1:
                    //    Bit 6-7: 0 = User settings
                    //    Bit 0-5:User whose limits are being set (0,1 or 2)
                    // Data byte 2-5: Bit field with settings
                    //    Bit  0-11: Maximum allowed ontime [10us]
                    //    Bit 12-22: Maximum allowed BPS/interrupt frequency [10Hz]
                    //    Bit 23-31: Maximum allowed duty [1/1000]
                    //
                    // sys0 will contain the bit field (a.k.a. the data bytes 2-5)
                    // sys1 is used as temp variable
                    // sys2 is the coil number
                    sys0=u0Ontime.val/10
                    sys1=u0BPS.val/10
                    sys1=sys1<<12
                    sys0+=sys1
                    sys1=u0Duty.val<<23
                    sys0+=sys1
                    prints "d",1
                    prints 0,1
                    prints sys0,4
                    sys0=u1Ontime.val/10
                    sys1=u1BPS.val/10
                    sys1=sys1<<12
                    sys0+=sys1
                    sys1=u1Duty.val<<23
                    sys0+=sys1
                    prints "d",1
                    prints 1,1
                    prints sys0,4
                    sys0=u2Ontime.val/10
                    sys1=u2BPS.val/10
                    sys1=sys1<<12
                    sys0+=sys1
                    sys1=u2Duty.val<<23
                    sys0+=sys1
                    prints "d",1
                    prints 2,1
                    prints sys0,4
                
                Touch Release Event
                    page Settings
                
        Text tUser
            Properties
                Scope       : Local
                Initial Text: " Guest"
                Max. length : 32
            
            Events
                Touch Press Event
                    
                Touch Release Event
                    
        Text tU0Name
            Properties
                Scope       : Local
                Initial Text: "Padawan"
                Max. length : 16
            
            Events
                Touch Press Event
                    
                Touch Release Event
                    if(tUser.txt!=u0Name.txt)
                    {
                        Keyboard.origin.val=dp
                        Keyboard.target.val=u0Name.id
                        Keyboard.sComp.txt="User 0 Name"
                        page Keyboard
                    }
                
        Text tU0Code
            Properties
                Scope       : Local
                Initial Text: "1234"
                Max. length : 16
            
            Events
                Touch Press Event
                    tU0Code.pw=0
                
                Touch Release Event
                    tU0Code.pw=1
                    if(tUser.txt!=u0Name.txt)
                    {
                        Keyboard.origin.val=dp
                        Keyboard.target.val=u0Code.id
                        Keyboard.sComp.txt="User 0 Code"
                        page Keyboard
                    }
                
        Text tUserCode
            Properties
                Scope       : Local
                Initial Text: "Code:"
                Max. length : 12
            
            Events
                Touch Press Event
                    
                Touch Release Event
                    
        Text tU1Name
            Properties
                Scope       : Local
                Initial Text: "Jedi Knight"
                Max. length : 16
            
            Events
                Touch Press Event
                    
                Touch Release Event
                    if(tUser.txt!=u0Name.txt)
                    {
                        Keyboard.origin.val=dp
                        Keyboard.target.val=u1Name.id
                        Keyboard.sComp.txt="User 1 Name"
                        page Keyboard
                    }
                
        Text tU1Code
            Properties
                Scope       : Local
                Initial Text: "2345"
                Max. length : 16
            
            Events
                Touch Press Event
                    tU1Code.pw=0
                
                Touch Release Event
                    tU1Code.pw=1
                    if(tUser.txt!=u0Name.txt)
                    {
                        Keyboard.origin.val=dp
                        Keyboard.target.val=u1Code.id
                        Keyboard.sComp.txt="User 1 Code"
                        page Keyboard
                    }
                
        Text tUserOntime
            Properties
                Scope       : Local
                Initial Text: "max. Ontime:"
                Max. length : 12
            
            Events
                Touch Press Event
                    
                Touch Release Event
                    
        Text tUserName
            Properties
                Scope       : Local
                Initial Text: "Name:"
                Max. length : 12
            
            Events
                Touch Press Event
                    
                Touch Release Event
                    
        Text tU2Name
            Properties
                Scope       : Local
                Initial Text: "Master Yoda"
                Max. length : 16
            
            Events
                Touch Press Event
                    
                Touch Release Event
                    if(tUser.txt==u2Name.txt)
                    {
                        Keyboard.origin.val=dp
                        Keyboard.target.val=u2Name.id
                        Keyboard.sComp.txt="User 2 Name"
                        page Keyboard
                    }
                
        Text tU2Code
            Properties
                Scope       : Local
                Initial Text: "0"
                Max. length : 16
            
            Events
                Touch Press Event
                    tU2Code.pw=0
                
                Touch Release Event
                    tU2Code.pw=1
                    if(tUser.txt==u2Name.txt)
                    {
                        Keyboard.origin.val=dp
                        Keyboard.target.val=u2Code.id
                        Keyboard.sComp.txt="User 2 Code"
                        page Keyboard
                    }
                
        Variable tAutoCode
            Properties
                Scope         : Global
                Type          : String
                Initial String: "0"
                Max. length   : 1
            
        Text tUserDuty
            Properties
                Scope       : Local
                Initial Text: "max. Duty:"
                Max. length : 12
            
            Events
                Touch Press Event
                    
                Touch Release Event
                    
        Text tUserBPS
            Properties
                Scope       : Local
                Initial Text: "max. BPS:"
                Max. length : 12
            
            Events
                Touch Press Event
                    
                Touch Release Event
                    
        Number user0BPS
            Properties
                Scope        : Local
                Initial Value: 1000
            
            Events
                Touch Press Event
                    // Check if values are legal
                    click fCheck,0
                    if(User_Settings.userNum.val!=0)
                    {
                        // Reset push state of last selected value
                        b[newValTargetId.val].bco=idle.bco
                        b[newValTargetId.val].pco=idle.pco
                        // Mark this field as pushed
                        user0BPS.bco=idle.pco
                        user0BPS.pco=idle.bco
                        newValTargetId.val=user0BPS.id
                        // A new value has been selected
                        newSelect.val=1
                    }
                
                Touch Release Event
                    // Code for using the Keyboard page
                    //if(tUser.txt!=u0Name.txt)
                    //{
                    //  Keyboard.origin.val=dp
                    //  Keyboard.target.val=u0BPS.id
                    //  Keyboard.sComp.txt="User 0 BPS"
                    //  page Keyboard
                    //}
                
        Float user0Duty
            Properties
                Scope           : Local
                Initial Value   : 60
                Divide by [10^x]: 1
            
            Events
                Touch Press Event
                    // .val is in 10ths of percent
                    // Check if values are legal
                    click fCheck,0
                    if(User_Settings.userNum.val!=0)
                    {
                        // Reset push state of last selected value
                        b[newValTargetId.val].bco=idle.bco
                        b[newValTargetId.val].pco=idle.pco
                        // Mark this field as pushed
                        user0Duty.bco=idle.pco
                        user0Duty.pco=idle.bco
                        newValTargetId.val=user0Duty.id
                        // A new value has been selected
                        newSelect.val=1
                    }
                
                Touch Release Event
                    // Code for using the Keyboard page
                    //if(tUser.txt!=u0Name.txt)
                    //{
                    //  Keyboard.origin.val=dp
                    //  Keyboard.target.val=u0Duty.id
                    //  Keyboard.sComp.txt="User 0 Duty"
                    //  page Keyboard
                    //}
                
        Number user0Ontime
            Properties
                Scope        : Local
                Initial Value: 100
            
            Events
                Touch Press Event
                    // Check if values are legal
                    click fCheck,0
                    if(User_Settings.userNum.val!=0)
                    {
                        // Reset push state of last selected value
                        b[newValTargetId.val].bco=idle.bco
                        b[newValTargetId.val].pco=idle.pco
                        // Mark this field as pushed
                        user0Ontime.bco=idle.pco
                        user0Ontime.pco=idle.bco
                        newValTargetId.val=user0Ontime.id
                        // A new value has been selected
                        newSelect.val=1
                    }
                
                Touch Release Event
                    // Code for using the Keyboard page
                    //if(tUser.txt!=u0Name.txt)
                    //{
                    //  Keyboard.origin.val=dp
                    //  Keyboard.target.val=u0Ontime.id
                    //  Keyboard.sComp.txt="User 0 Ontime"
                    //  page Keyboard
                    //}
                
        Number user1BPS
            Properties
                Scope        : Local
                Initial Value: 1000
            
            Events
                Touch Press Event
                    // Check if values are legal
                    click fCheck,0
                    if(User_Settings.userNum.val==2)
                    {
                        // Reset push state of last selected value
                        b[newValTargetId.val].bco=idle.bco
                        b[newValTargetId.val].pco=idle.pco
                        // Mark this field as pushed
                        user1BPS.bco=idle.pco
                        user1BPS.pco=idle.bco
                        newValTargetId.val=user1BPS.id
                        // A new value has been selected
                        newSelect.val=1
                    }
                
                Touch Release Event
                    // Code for using the Keyboard page
                    //if(tUser.txt==u2Name.txt)
                    //{
                    //  Keyboard.origin.val=dp
                    //  Keyboard.target.val=u1BPS.id
                    //  Keyboard.sComp.txt="User 1 BPS"
                    //  page Keyboard
                    //}
                
        Float user1Duty
            Properties
                Scope           : Local
                Initial Value   : 80
                Divide by [10^x]: 1
            
            Events
                Touch Press Event
                    // Check if values are legal
                    click fCheck,0
                    // .val is in 10ths of percent
                    if(User_Settings.userNum.val==2)
                    {
                        // Reset push state of last selected value
                        b[newValTargetId.val].bco=idle.bco
                        b[newValTargetId.val].pco=idle.pco
                        // Mark this field as pushed
                        user1Duty.bco=idle.pco
                        user1Duty.pco=idle.bco
                        newValTargetId.val=user1Duty.id
                        // A new value has been selected
                        newSelect.val=1
                    }
                
                Touch Release Event
                    //if(tUser.txt==u2Name.txt)
                    //{
                    //  Keyboard.origin.val=dp
                    //  Keyboard.target.val=u1Duty.id
                    //  Keyboard.sComp.txt="User 1 Duty"
                    //  page Keyboard
                    //}
                
        Number user1Ontime
            Properties
                Scope        : Local
                Initial Value: 8211
            
            Events
                Touch Press Event
                    // Check if values are legal
                    click fCheck,0
                    if(User_Settings.userNum.val==2)
                    {
                        // Reset push state of last selected value
                        b[newValTargetId.val].bco=idle.bco
                        b[newValTargetId.val].pco=idle.pco
                        // Mark this field as pushed
                        user1Ontime.bco=idle.pco
                        user1Ontime.pco=idle.bco
                        newValTargetId.val=user1Ontime.id
                        // A new value has been selected
                        newSelect.val=1
                    }
                
                Touch Release Event
                    // Code for using the Keyboard page
                    //if(tUser.txt==u2Name.txt)
                    //{
                    //  Keyboard.origin.val=dp
                    //  Keyboard.target.val=u1Ontime.id
                    //  Keyboard.sComp.txt="User 1 Ontime"
                    //  page Keyboard
                    //}
                
        Number user2BPS
            Properties
                Scope        : Local
                Initial Value: 1000
            
            Events
                Touch Press Event
                    // Check if values are legal
                    click fCheck,0
                    if(tUser.txt==u2Name.txt)
                    {
                        // Reset push state of last selected value
                        b[newValTargetId.val].bco=idle.bco
                        b[newValTargetId.val].pco=idle.pco
                        // Mark this field as pushed
                        user2BPS.bco=idle.pco
                        user2BPS.pco=idle.bco
                        newValTargetId.val=user2BPS.id
                        // A new value has been selected
                        newSelect.val=1
                    }
                
                Touch Release Event
                    //if(tUser.txt==u2Name.txt)
                    //{
                    //  Keyboard.origin.val=dp
                    //  Keyboard.target.val=u2BPS.id
                    //  Keyboard.sComp.txt="User 2 BPS"
                    //  page Keyboard
                    //}
                
        Float user2Duty
            Properties
                Scope           : Local
                Initial Value   : 100
                Divide by [10^x]: 1
            
            Events
                Touch Press Event
                    // .val is in 10ths of percent
                    // This value is automatically determined by the microcontroller from the max coil settings.Currently it is only updated at startup.
                    // Check if values are legal
                    //click fCheck,0
                    //if(tUser.txt==u2Name.txt)
                    //{
                    // Reset push state of last selected value
                    //  b[newValTargetId.val].bco=idle.bco
                    //  b[newValTargetId.val].pco=idle.pco
                    // Mark this field as pushed
                    //  user2Duty.bco=idle.pco
                    //  user2Duty.pco=idle.bco
                    //  newValTargetId.val=user2Duty.id
                    // A new value has been selected
                    //  newSelect.val=1
                    //}
                
                Touch Release Event
                    //if(tUser.txt==u2Name.txt)
                    //{
                    //  Keyboard.origin.val=dp
                    //  Keyboard.target.val=u2Duty.id
                    //  Keyboard.sComp.txt="User 2 Duty"
                    //  page Keyboard
                    //}
                
        Number user2Ontime
            Properties
                Scope        : Local
                Initial Value: 200
            
            Events
                Touch Press Event
                    // This value is automatically determined by the microcontroller from the max coil settings.Currently it is only updated at startup.
                    // Check if values are legal
                    //click fCheck,0
                    //if(tUser.txt==u2Name.txt)
                    //{
                    // Reset push state of last selected value
                    //  b[newValTargetId.val].bco=idle.bco
                    //  b[newValTargetId.val].pco=idle.pco
                    // Mark this field as pushed
                    //  user2Ontime.bco=idle.pco
                    //  user2Ontime.pco=idle.bco
                    //  newValTargetId.val=user2Ontime.id
                    // A new value has been selected
                    //  newSelect.val=1
                    //}
                
                Touch Release Event
                    //if(tUser.txt==u2Name.txt)
                    //{
                    //  Keyboard.origin.val=dp
                    //  Keyboard.target.val=u2Ontime.id
                    //  Keyboard.sComp.txt="User 2 Ontime"
                    //  page Keyboard
                    //}
                
        Text tus0
            Properties
                Scope       : Local
                Initial Text: "µs"
                Max. length : 2
            
            Events
                Touch Press Event
                    
                Touch Release Event
                    
        Text tHz0
            Properties
                Scope       : Local
                Initial Text: "Hz"
                Max. length : 2
            
            Events
                Touch Press Event
                    
                Touch Release Event
                    
        Text tPerc0
            Properties
                Scope       : Local
                Initial Text: "%"
                Max. length : 1
            
            Events
                Touch Press Event
                    
                Touch Release Event
                    
        Text tus1
            Properties
                Scope       : Local
                Initial Text: "µs"
                Max. length : 2
            
            Events
                Touch Press Event
                    
                Touch Release Event
                    
        Text tHz1
            Properties
                Scope       : Local
                Initial Text: "Hz"
                Max. length : 2
            
            Events
                Touch Press Event
                    
                Touch Release Event
                    
        Text tPerc1
            Properties
                Scope       : Local
                Initial Text: "%"
                Max. length : 1
            
            Events
                Touch Press Event
                    
                Touch Release Event
                    
        Text tus2
            Properties
                Scope       : Local
                Initial Text: "µs"
                Max. length : 2
            
            Events
                Touch Press Event
                    
                Touch Release Event
                    
        Text tHz2
            Properties
                Scope       : Local
                Initial Text: "Hz"
                Max. length : 2
            
            Events
                Touch Press Event
                    
                Touch Release Event
                    
        Text tPerc2
            Properties
                Scope       : Local
                Initial Text: "%"
                Max. length : 1
            
            Events
                Touch Press Event
                    
                Touch Release Event
                    
        Variable u0Name
            Properties
                Scope         : Global
                Type          : String
                Initial String: "Padawan"
                Max. length   : 16
            
        Variable u0Code
            Properties
                Scope         : Global
                Type          : String
                Initial String: "1234"
                Max. length   : 16
            
        Variable u0Ontime
            Properties
                Scope         : Global
                Type          : int32
                Initial Value : 100
            
        Variable u0BPS
            Properties
                Scope         : Global
                Type          : int32
                Initial Value : 1000
            
        Variable u0Duty
            Properties
                Scope         : Global
                Type          : int32
                Initial Value : 60
            
        Variable u1Name
            Properties
                Scope         : Global
                Type          : String
                Initial String: "Jedi Knight"
                Max. length   : 16
            
        Variable u1Code
            Properties
                Scope         : Global
                Type          : String
                Initial String: "8079"
                Max. length   : 16
            
        Variable u1Ontime
            Properties
                Scope         : Global
                Type          : int32
                Initial Value : 8211
            
        Variable u1BPS
            Properties
                Scope         : Global
                Type          : int32
                Initial Value : 1000
            
        Variable u1Duty
            Properties
                Scope         : Global
                Type          : int32
                Initial Value : 80
            
        Variable u2Name
            Properties
                Scope         : Global
                Type          : String
                Initial String: "Master Yoda"
                Max. length   : 16
            
        Variable u2Code
            Properties
                Scope         : Global
                Type          : String
                Initial String: "0"
                Max. length   : 16
            
        Variable u2Ontime
            Properties
                Scope         : Global
                Type          : int32
                Initial Value : 200
            
        Variable u2BPS
            Properties
                Scope         : Global
                Type          : int32
                Initial Value : 1000
            
        Variable u2Duty
            Properties
                Scope         : Global
                Type          : int32
                Initial Value : 100
            
        Button b0
            Properties
                Scope      : Local
                Caption    : "0"
                Max. length: 1
            
            Events
                Touch Press Event
                    
                Touch Release Event
                    if(newSelect.val!=0)
                    {
                        newSelect.val=0
                        b[newValTargetId.val].val=0
                    }else
                    {
                        b[newValTargetId.val].val*=10
                    }
                
        Button b1
            Properties
                Scope      : Local
                Caption    : "1"
                Max. length: 1
            
            Events
                Touch Press Event
                    
                Touch Release Event
                    if(newSelect.val!=0)
                    {
                        newSelect.val=0
                        b[newValTargetId.val].val=0
                    }else
                    {
                        b[newValTargetId.val].val*=10
                    }
                    b[newValTargetId.val].val+=1
                
        Button b2
            Properties
                Scope      : Local
                Caption    : "2"
                Max. length: 1
            
            Events
                Touch Press Event
                    
                Touch Release Event
                    if(newSelect.val!=0)
                    {
                        newSelect.val=0
                        b[newValTargetId.val].val=0
                    }else
                    {
                        b[newValTargetId.val].val*=10
                    }
                    b[newValTargetId.val].val+=2
                
        Button b3
            Properties
                Scope      : Local
                Caption    : "3"
                Max. length: 1
            
            Events
                Touch Press Event
                    
                Touch Release Event
                    if(newSelect.val!=0)
                    {
                        newSelect.val=0
                        b[newValTargetId.val].val=0
                    }else
                    {
                        b[newValTargetId.val].val*=10
                    }
                    b[newValTargetId.val].val+=3
                
        Button b4
            Properties
                Scope      : Local
                Caption    : "4"
                Max. length: 1
            
            Events
                Touch Press Event
                    
                Touch Release Event
                    if(newSelect.val!=0)
                    {
                        newSelect.val=0
                        b[newValTargetId.val].val=0
                    }else
                    {
                        b[newValTargetId.val].val*=10
                    }
                    b[newValTargetId.val].val+=4
                
        Button b5
            Properties
                Scope      : Local
                Caption    : "5"
                Max. length: 1
            
            Events
                Touch Press Event
                    
                Touch Release Event
                    if(newSelect.val!=0)
                    {
                        newSelect.val=0
                        b[newValTargetId.val].val=0
                    }else
                    {
                        b[newValTargetId.val].val*=10
                    }
                    b[newValTargetId.val].val+=5
                
        Button b6
            Properties
                Scope      : Local
                Caption    : "6"
                Max. length: 1
            
            Events
                Touch Press Event
                    
                Touch Release Event
                    if(newSelect.val!=0)
                    {
                        newSelect.val=0
                        b[newValTargetId.val].val=0
                    }else
                    {
                        b[newValTargetId.val].val*=10
                    }
                    b[newValTargetId.val].val+=6
                
        Button b7
            Properties
                Scope      : Local
                Caption    : "7"
                Max. length: 1
            
            Events
                Touch Press Event
                    
                Touch Release Event
                    if(newSelect.val!=0)
                    {
                        newSelect.val=0
                        b[newValTargetId.val].val=0
                    }else
                    {
                        b[newValTargetId.val].val*=10
                    }
                    b[newValTargetId.val].val+=7
                
        Button b8
            Properties
                Scope      : Local
                Caption    : "8"
                Max. length: 1
            
            Events
                Touch Press Event
                    
                Touch Release Event
                    if(newSelect.val!=0)
                    {
                        newSelect.val=0
                        b[newValTargetId.val].val=0
                    }else
                    {
                        b[newValTargetId.val].val*=10
                    }
                    b[newValTargetId.val].val+=8
                
        Button b9
            Properties
                Scope      : Local
                Caption    : "9"
                Max. length: 1
            
            Events
                Touch Press Event
                    
                Touch Release Event
                    if(newSelect.val!=0)
                    {
                        newSelect.val=0
                        b[newValTargetId.val].val=0
                    }else
                    {
                        b[newValTargetId.val].val*=10
                    }
                    b[newValTargetId.val].val+=9
                
        Button bClear
            Properties
                Scope      : Local
                Caption    : "X"
                Max. length: 1
            
            Events
                Touch Press Event
                    
                Touch Release Event
                    b[newValTargetId.val].val=0
                
        Button bOK
            Properties
                Scope      : Local
                Caption    : "ok"
                Max. length: 2
            
            Events
                Touch Press Event
                    
                Touch Release Event
                    b[newValTargetId.val].bco=idle.bco
                    b[newValTargetId.val].pco=idle.pco
                    newValTargetId.val=idle.id
                    // Check if values are legal
                    click fCheck,0
                
        Text tSelToMod
            Properties
                Scope       : Local
                Initial Text: "Select any value to modify."
                Max. length : 30
            
            Events
                Touch Press Event
                    
                Touch Release Event
                    
        Variable newValTargetId
            Properties
                Scope         : Local
                Type          : int32
                Initial Value : 64
            
        Variable newSelect
            Properties
                Scope         : Local
                Type          : int32
                Initial Value : 0
            
        Float idle
            Properties
                Scope           : Local
                Initial Value   : 0
                Divide by [10^x]: 0
            
            Events
                Touch Press Event
                    
                Touch Release Event
                    
        Variable userNum
            Properties
                Scope         : Global
                Type          : int32
                Initial Value : 0
            
        Text fCheck
            Properties
                Scope       : Local
                Initial Text: " "
                Max. length : 10
            
            Events
                Touch Press Event
                    
                Touch Release Event
                    // Settings must stay in certain ranges. this function checks and fixes them.
                    // Code order: check all coil 1 settings, then repeat for coils 2-6.
                    //
                    sys0=user0Ontime.val/10
                    if(sys0>4095)
                    {
                        // Ontime / 10 must be smaller than 4096 (12 bits)
                        sys0=4095
                    }
                    user0Ontime.val=sys0*10
                    //
                    sys0=user0BPS.val/10
                    if(sys0>2047)
                    {
                        // BPS / 10 must be smaller than 2048 (11 bits)
                        sys0=2047
                    }
                    user0BPS.val=sys0*10
                    //
                    if(user0Duty.val>511)
                    {
                        // Duty [in 1/1000] must be smaller than 512 (9 bits)
                        sys0=511
                    }
                    //
                    sys0=user1Ontime.val/10
                    if(sys0>4095)
                    {
                        // Ontime / 10 must be smaller than 4096 (12 bits)
                        sys0=4095
                    }
                    user1Ontime.val=sys0*10
                    //
                    sys0=user1BPS.val/10
                    if(sys0>2047)
                    {
                        // BPS / 10 must be smaller than 2048 (11 bits)
                        sys0=2047
                    }
                    user1BPS.val=sys0*10
                    //
                    if(user1Duty.val>511)
                    {
                        // Duty [in 1/1000] must be smaller than 512 (9 bits)
                        sys0=511
                    }
                    //
                    sys0=user2Ontime.val/10
                    if(sys0>4095)
                    {
                        // Ontime / 10 must be smaller than 4096 (12 bits)
                        sys0=4095
                    }
                    user2Ontime.val=sys0*10
                    //
                    sys0=user2BPS.val/10
                    if(sys0>2047)
                    {
                        // BPS / 10 must be smaller than 2048 (11 bits)
                        sys0=2047
                    }
                    user2BPS.val=sys0*10
                    //
                    if(user2Duty.val>511)
                    {
                        // Duty [in 1/1000] must be smaller than 512 (9 bits)
                        sys0=511
                    }
                
